<meta charset="utf8" />
<html>
<script src='../libs/sql.js/sql-wasm.js'></script>
<script src='../libs/geopackage/geopackage.js'></script>



<script>

	const {GeoPackageConnection} = geopackage;

	initSqlJs({ locateFile: filename => "../libs/sql.js/sql-wasm.wasm" }).then(async function (SQL) {

		const file = `../examples/morro_bay_shp/gpkg/geopackage.gpkg`;

		const result = await fetch(file);
		const array = await result.arrayBuffer();
		const u8 = new Uint8Array(array);

		const data = await geopackage.open(u8);
		window.data = data;

		const dao = data.getFeatureDao("roads");
		const geoJson = data.queryForGeoJSONFeaturesInTable("roads", dao.getBoundingBox());

		console.log(geoJson);









		// const colName = dao.getGeometryColumnName();
		// let iterator = dao.queryForEach();

		// let item = iterator.next();
		// while(!item.done){
			
		// 	const value = item.value;

		// 	const {geom, name, type} = value;

		// 	const geometry = parseGeometry(geom);

		// 	console.log(value);

		// 	item = iterator.next();

		// 	break;
		// }



		console.log("tables: ", data.getFeatureTables().join(", "));
	});


</script>

<body>
	Output is in Javascript console
</body>

</html>